---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import Articles from "./_components/Articles.astro";
import type { Page } from "astro";
import Pagination from "@components/Pagination.astro";

export async function getStaticPaths({ paginate }: any) {
  const articles = (await getCollection("articles")).sort((a, b) =>
    b.data.publishedDate.getTime() <= a.data.publishedDate.getTime() ? -1 : 1
  );

  return paginate(articles, { pageSize: 1 });
}

interface Props {
  page: Page;
}

const { page } = Astro.props;
const title = "Article Index";
---

<BaseLayout {title} description={title}>
  <header>
    <h1>{title} | Page {page.currentPage}</h1>
  </header>
  <Articles articles={page.data} />
  <footer>
    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} {page} />
  </footer>
</BaseLayout>
