---
import MembershipPricing from "@components/MembershipPricing.astro";
import MembershipPricingHelper from "@components/MembershipPricingHelper";
import Prose from "@components/Prose.astro";
import Section from "@pages/courses/_layouts/Section.astro";
import { getCollection, getEntry } from "astro:content";

const membership = await getEntry("memberships", "personal");

const monthlyPrice = membership.data.packages.find(
  (e) => e.frequency === "monthly",
)!.price;
const monthlyTitle = "Monthly Membership";

const yearlyPrice = membership.data.packages.find(
  (e) => e.frequency === "yearly",
)!.price;
const yearlyTitle = "Yearly Membership";

const membershipHours = (await getCollection("courses"))
  .map((e) => e.data.benefits?.hours ?? 0)
  .reduce((b, a) => b + a);
const membershipLinesOfCode = (await getCollection("courses"))
  .map((e) => e.data.benefits?.linesOfCode ?? 0)
  .reduce((b, a) => b + a);
const membershipNumExamples = (await getCollection("courses"))
  .map((e) => e.data.benefits?.numExamples ?? 0)
  .reduce((b, a) => b + a);
const categories = (await getCollection("courseCategories")).sort((a, b) =>
  a.data.ordinal <= b.data.ordinal ? -1 : 1,
);
---

<Section color="bg-secondary" title="Get started now!">
  <!-- <MembershipPricing /> -->
  <MembershipPricingHelper
    {monthlyTitle}
    {monthlyPrice}
    {yearlyPrice}
    {yearlyTitle}
    {membershipHours}
    {membershipLinesOfCode}
    client:load
  />
</Section>
