---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import { getEntry } from "astro:content";
import Hero from "../_sections/Hero.astro";
import Goal from "../_sections/Goal.astro";
import Question from "../_sections/Question.astro";
import Features from "../_sections/Features.astro";
import Skills from "../_sections/Skills.astro";
import Pricing from "../_sections/Pricing.astro";
import CourseFAQ from "../_sections/CourseFAQ.astro";
import Profile from "@components/Profile.astro";


const { slug } = Astro.params;
const course = await getEntry("courses", slug!);
const frontmatter = course!.data;
const category = await getEntry("courseCategories", frontmatter.category.id);
const {
  answer,
  description,
  excerpt,
  faqs,
  features,
  bundledCourses,
  grouping,
  image,
  question,
  title,
} = frontmatter;

interface Comment {
  postId: number;
  id: number;
  name: string;
  email: string;
  body: string;
}

const response = await fetch(
  "https://jsonplaceholder.typicode.com/posts/1/comments"
);
const data: Comment[] = await response.json();
---

<BaseLayout {description} {title}>
  <article>
    <Hero {description} {image} {title} />
    <Goal>
      <slot name="goal" />
    </Goal>
    {
      question && (
        <Question
          color={`bg-[${category.data.color}]`}
          image={question.image}
          {question}
        >
          <slot name="question" />
        </Question>
      )
    }
    <Features color={`bg-[${category.data.color}]`} {features}>
      <slot name="feature1" slot="feature1" />
      <slot name="feature2" slot="feature2" />
      <slot name="feature3" slot="feature3" />
      <slot name="feature4" slot="feature4" />
      <slot name="feature5" slot="feature5" />
    </Features>
    <Skills color={`bg-[${category.data.color}]`}>
    {
      data.map((comment) => (
        <ul>
          <h2>{comment.name}</h2>
          <h3>{comment.email}</h3>
          <p>{comment.body}</p>
        </ul>
      ))
    }
    <Skills color="bg-secondary">
      <slot name="skills" />
    </Skills>
    <Profile color={`bg-[${category.data.color}]`} />
    <Pricing {course} {category} color={`bg-[${category.data.color}]`} />
    <CourseFAQ
      faq={course!.data.faqs ?? []}
      color={`bg-[${category.data.color}]`}
    />
  </article>
</BaseLayout>
